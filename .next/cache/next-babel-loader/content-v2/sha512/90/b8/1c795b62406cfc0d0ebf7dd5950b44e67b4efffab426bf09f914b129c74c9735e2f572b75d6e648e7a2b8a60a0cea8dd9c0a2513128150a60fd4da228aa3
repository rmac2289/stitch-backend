{"ast":null,"code":"import _regeneratorRuntime from \"/Users/rossmacdonald/Projects/stitchsell/frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _asyncToGenerator from \"/Users/rossmacdonald/Projects/stitchsell/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/rossmacdonald/Projects/stitchsell/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/rossmacdonald/Projects/stitchsell/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"/Users/rossmacdonald/Projects/stitchsell/frontend/components/SignIn.js\",\n    _s = $RefreshSig$();\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation SIGNIN_MUTATION($email: String!, $password: String!) {\\n    authenticateUserWithPassword(email: $email, password: $password) {\\n      ... on UserAuthenticationWithPasswordSuccess {\\n        item {\\n          id\\n          email\\n          name\\n        }\\n      }\\n      ... on UserAuthenticationWithPasswordFailure {\\n        code\\n        message\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport gql from \"graphql-tag\";\nimport { useMutation } from \"@apollo/client\";\nimport Form from \"./styles/Form\";\nimport useForm from \"../lib/useForm\";\nimport { CURRENT_USER_QUERY } from \"./User\";\nimport Error from \"./ErrorMessage\";\nimport { useRouter } from \"next/router\";\nimport { motion } from \"framer-motion\";\nvar SIGNIN_MUTATION = gql(_templateObject());\nexport default function SignIn() {\n  _s();\n\n  var router = useRouter();\n\n  var _useForm = useForm({\n    email: \"\",\n    password: \"\"\n  }),\n      inputs = _useForm.inputs,\n      handleChange = _useForm.handleChange,\n      resetForm = _useForm.resetForm;\n\n  var _useMutation = useMutation(SIGNIN_MUTATION, {\n    variables: inputs,\n    // refetch the currently logged in user\n    refetchQueries: [{\n      query: CURRENT_USER_QUERY\n    }]\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      signin = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      data = _useMutation2$.data,\n      loading = _useMutation2$.loading;\n\n  function handleSubmit(_x) {\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  function _handleSubmit() {\n    _handleSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault(); // stop the form from submitting\n\n              _context.next = 3;\n              return signin();\n\n            case 3:\n              res = _context.sent;\n              resetForm();\n              res.data.authenticateUserWithPassword.code !== \"FAILURE\" ? router.push(\"/\") : null; // Send the email and password to the graphqlAPI\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  var error = (data === null || data === void 0 ? void 0 : data.authenticateUserWithPassword.__typename) === \"UserAuthenticationWithPasswordFailure\" ? data === null || data === void 0 ? void 0 : data.authenticateUserWithPassword : undefined;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(motion.div, {\n      initial: {\n        opacity: 0\n      },\n      animate: {\n        opacity: 1\n      },\n      transition: {\n        duration: 0.5\n      },\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        method: \"POST\",\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Sign Into Your Account\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Error, {\n          error: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"fieldset\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"email\",\n            children: [\"Email\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"email\",\n              name: \"email\",\n              placeholder: \"Your Email Address\",\n              autoComplete: \"email\",\n              value: inputs.email,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 67,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"password\",\n            children: [\"Password\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"password\",\n              name: \"password\",\n              placeholder: \"Password\",\n              autoComplete: \"password\",\n              value: inputs.password,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 78,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            children: \"Sign In\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n\n_s(SignIn, \"ypgEKpwZOfHtA/3/UCvITbxm7Qc=\", false, function () {\n  return [useRouter, useForm, useMutation];\n});\n\n_c = SignIn;\n\nvar _c;\n\n$RefreshReg$(_c, \"SignIn\");","map":{"version":3,"sources":["/Users/rossmacdonald/Projects/stitchsell/frontend/components/SignIn.js"],"names":["gql","useMutation","Form","useForm","CURRENT_USER_QUERY","Error","useRouter","motion","SIGNIN_MUTATION","SignIn","router","email","password","inputs","handleChange","resetForm","variables","refetchQueries","query","signin","data","loading","handleSubmit","e","preventDefault","res","authenticateUserWithPassword","code","push","error","__typename","undefined","opacity","duration"],"mappings":"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","sourcesContent":["import gql from \"graphql-tag\";\nimport { useMutation } from \"@apollo/client\";\nimport Form from \"./styles/Form\";\nimport useForm from \"../lib/useForm\";\nimport { CURRENT_USER_QUERY } from \"./User\";\nimport Error from \"./ErrorMessage\";\nimport { useRouter } from \"next/router\";\nimport { motion } from \"framer-motion\";\n\nconst SIGNIN_MUTATION = gql`\n  mutation SIGNIN_MUTATION($email: String!, $password: String!) {\n    authenticateUserWithPassword(email: $email, password: $password) {\n      ... on UserAuthenticationWithPasswordSuccess {\n        item {\n          id\n          email\n          name\n        }\n      }\n      ... on UserAuthenticationWithPasswordFailure {\n        code\n        message\n      }\n    }\n  }\n`;\n\nexport default function SignIn() {\n  const router = useRouter();\n  const { inputs, handleChange, resetForm } = useForm({\n    email: \"\",\n    password: \"\",\n  });\n  const [signin, { data, loading }] = useMutation(SIGNIN_MUTATION, {\n    variables: inputs,\n    // refetch the currently logged in user\n    refetchQueries: [{ query: CURRENT_USER_QUERY }],\n  });\n\n  async function handleSubmit(e) {\n    e.preventDefault(); // stop the form from submitting\n    const res = await signin();\n    resetForm();\n    res.data.authenticateUserWithPassword.code !== \"FAILURE\"\n      ? router.push(\"/\")\n      : null;\n    // Send the email and password to the graphqlAPI\n  }\n  const error =\n    data?.authenticateUserWithPassword.__typename ===\n    \"UserAuthenticationWithPasswordFailure\"\n      ? data?.authenticateUserWithPassword\n      : undefined;\n  return (\n    <>\n      <motion.div\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        transition={{ duration: 0.5 }}\n      >\n        <Form method=\"POST\" onSubmit={handleSubmit}>\n          <h2>Sign Into Your Account</h2>\n          <Error error={error} />\n          <fieldset>\n            <label htmlFor=\"email\">\n              Email\n              <input\n                type=\"email\"\n                name=\"email\"\n                placeholder=\"Your Email Address\"\n                autoComplete=\"email\"\n                value={inputs.email}\n                onChange={handleChange}\n              />\n            </label>\n            <label htmlFor=\"password\">\n              Password\n              <input\n                type=\"password\"\n                name=\"password\"\n                placeholder=\"Password\"\n                autoComplete=\"password\"\n                value={inputs.password}\n                onChange={handleChange}\n              />\n            </label>\n            <button type=\"submit\">Sign In</button>\n          </fieldset>\n        </Form>\n      </motion.div>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}